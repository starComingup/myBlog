(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{477:function(_,v,n){"use strict";n.r(v);var r=n(12),t=Object(r.a)({},(function(){var _=this,v=_.$createElement,n=_._self._c||v;return n("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[n("h1",{attrs:{id:"nginx安全风险评估以及配置策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx安全风险评估以及配置策略"}},[_._v("#")]),_._v(" Nginx安全风险评估以及配置策略")]),_._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[_._v("参考来源")]),_._v(" "),n("p",[_._v("阿里云安全中心基线检查，该部分仅为最佳安全实践，仅供参考")])]),_._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#身份鉴别类"}},[_._v("身份鉴别类")]),n("ul",[n("li",[n("a",{attrs:{href:"#检查是否配置nginx账号锁定策略"}},[_._v("检查是否配置Nginx账号锁定策略")])])])]),n("li",[n("a",{attrs:{href:"#服务配置类"}},[_._v("服务配置类")]),n("ul",[n("li",[n("a",{attrs:{href:"#检查nginx进程启动账号"}},[_._v("检查Nginx进程启动账号")])]),n("li",[n("a",{attrs:{href:"#nginx后端服务指定的header隐藏状态"}},[_._v("Nginx后端服务指定的Header隐藏状态")])]),n("li",[n("a",{attrs:{href:"#nginx的web访问日志记录状态"}},[_._v("Nginx的WEB访问日志记录状态")])]),n("li",[n("a",{attrs:{href:"#隐藏nginx服务的banner"}},[_._v("隐藏Nginx服务的Banner")])]),n("li",[n("a",{attrs:{href:"#针对nginx-ssl协议进行安全加固"}},[_._v("针对Nginx SSL协议进行安全加固")])])])]),n("li",[n("a",{attrs:{href:"#访问控制类"}},[_._v("访问控制类")]),n("ul",[n("li",[n("a",{attrs:{href:"#确保已禁用自动索引模块"}},[_._v("确保已禁用自动索引模块")])])])]),n("li",[n("a",{attrs:{href:"#文件权限类"}},[_._v("文件权限类")]),n("ul",[n("li",[n("a",{attrs:{href:"#确保nginx配置文件权限为644"}},[_._v("确保Nginx配置文件权限为644")])])])])])]),n("p"),_._v(" "),n("h2",{attrs:{id:"身份鉴别类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#身份鉴别类"}},[_._v("#")]),_._v(" 身份鉴别类")]),_._v(" "),n("h3",{attrs:{id:"检查是否配置nginx账号锁定策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#检查是否配置nginx账号锁定策略"}},[_._v("#")]),_._v(" 检查是否配置Nginx账号锁定策略")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("1.执行系统命令passwd -S nginx来查看锁定状态 出现Password locked证明锁定成功 如：nginx LK ..... (Password locked.)或nginx L .... 2.默认符合，修改后才有（默认已符合） 3.执行系统命令passwd -l nginx进行锁定")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("配置Nginx账号登录锁定策略： Nginx服务建议使用非root用户(如nginx，nobody)启动，并且确保启动用户的状态为锁定状态。可执行passwd -l <Nginx启动用户> 如"),n("code",[_._v("passwd -l nginx")]),_._v(" 来锁定Nginx服务的启动用户。命令 "),n("code",[_._v("passwd -S <用户>")]),_._v(" 如"),n("code",[_._v("passwd -S nginx")]),_._v("可查看用户状态。 修改配置文件中的nginx启动用户修改为nginx或nobody 如： "),n("code",[_._v("user nobody;")]),_._v(" 如果您是docker用户，可忽略该项（或添加白名单）")]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h2",{attrs:{id:"服务配置类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务配置类"}},[_._v("#")]),_._v(" 服务配置类")]),_._v(" "),n("h3",{attrs:{id:"检查nginx进程启动账号"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#检查nginx进程启动账号"}},[_._v("#")]),_._v(" 检查Nginx进程启动账号")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("Nginx进程启动账号状态，降低被攻击概率")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("修改Nginx进程启动账号： 1、打开"),n("code",[_._v("conf/nginx.conf")]),_._v("配置文件； 2、查看配置文件的user配置项，确认是非root启动的； 3、如果是"),n("code",[_._v("root")]),_._v("启动，修改成"),n("code",[_._v("nobody")]),_._v("或者"),n("code",[_._v("nginx账号")]),_._v("； 备注： 4、修改完配置文件之后需要重新启动Nginx。")]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h3",{attrs:{id:"nginx后端服务指定的header隐藏状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx后端服务指定的header隐藏状态"}},[_._v("#")]),_._v(" Nginx后端服务指定的Header隐藏状态")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("隐藏Nginx后端服务X-Powered-By头")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("隐藏Nginx后端服务指定Header的状态： 1、打开"),n("code",[_._v("conf/nginx.conf")]),_._v("配置文件； 2、在"),n("code",[_._v("http")]),_._v("下配置"),n("code",[_._v("proxy_hide_header")]),_._v("项； 增加或修改为 "),n("code",[_._v("proxy_hide_header X-Powered-By;")]),_._v(" "),n("code",[_._v("proxy_hide_header Server;")])]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h3",{attrs:{id:"nginx的web访问日志记录状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx的web访问日志记录状态"}},[_._v("#")]),_._v(" Nginx的WEB访问日志记录状态")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("应为每个核心站点启用access_log指令。默认情况下启用。")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("开启Nginx的WEB访问日志记录： 1、打开"),n("code",[_._v("conf/nginx.conf")]),_._v("配置文件，含主配置文件中include项包含的子配置文件； 2、在http下配置"),n("code",[_._v("access_log")]),_._v("项\n"),n("code",[_._v("access_log logs/host.access.log main;")]),_._v(" 3、并在主配置文件，及主配置文件下的include文件中 删除"),n("code",[_._v("off")]),_._v("项或配置为适当值")]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h3",{attrs:{id:"隐藏nginx服务的banner"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#隐藏nginx服务的banner"}},[_._v("#")]),_._v(" 隐藏Nginx服务的Banner")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("Nginx服务的Banner隐藏状态")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("Nginx后端服务指定的Header隐藏状态隐藏Nginx服务Banner的状态： 1、打开"),n("code",[_._v("conf/nginx.conf")]),_._v("配置文件； 2、在server栏目下，配置"),n("code",[_._v("server_tokens")]),_._v("项 "),n("code",[_._v("server_tokens off;")]),_._v(" 如出现多项不支持，执行"),n("code",[_._v("ln <conf_path> /etc/nginx/nginx.conf")])]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h3",{attrs:{id:"针对nginx-ssl协议进行安全加固"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#针对nginx-ssl协议进行安全加固"}},[_._v("#")]),_._v(" 针对Nginx SSL协议进行安全加固")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("Nginx SSL协议的加密策略进行加固")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("Nginx SSL协议采用TLSv1.2： 1、打开"),n("code",[_._v("conf/nginx.conf")]),_._v("配置文件（或主配置文件中的inlude文件）； 2、配置")]),_._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[_._v("server { \n               ...\n              ssl_protocols TLSv1.2;\n               ...\n                     }\n")])]),_._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[_._v("1")]),n("br"),n("span",{staticClass:"line-number"},[_._v("2")]),n("br"),n("span",{staticClass:"line-number"},[_._v("3")]),n("br"),n("span",{staticClass:"line-number"},[_._v("4")]),n("br"),n("span",{staticClass:"line-number"},[_._v("5")]),n("br")])]),n("p",[_._v("备注：配置此项请确认nginx支持OpenSSL，运行"),n("code",[_._v("nginx -V")]),_._v(" 如果返回中包含"),n("code",[_._v("built with OpenSSL")]),_._v("则表示支持OpenSSL。 如不支持，可能需要增加配置ssl_protocols TLSv1 TLSv1.1 TLSv1.2; 如果尚未配置ssl协议，请尽快配置（参考连接"),n("a",{attrs:{href:"https://www.nginx.cn/doc/optional/ssl.html%EF%BC%89",target:"_blank",rel:"noopener noreferrer"}},[_._v("https://www.nginx.cn/doc/optional/ssl.html）"),n("OutboundLink")],1)]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h2",{attrs:{id:"访问控制类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#访问控制类"}},[_._v("#")]),_._v(" 访问控制类")]),_._v(" "),n("h3",{attrs:{id:"确保已禁用自动索引模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#确保已禁用自动索引模块"}},[_._v("#")]),_._v(" 确保已禁用自动索引模块")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("自动索引模块处理以斜杠字符结尾的请求。此功能启用目录列表，这在攻击者侦察中可能很有用，因此应将其禁用。")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("执行以下操作以禁用自动索引模块: 搜索NGINX配置文件（NGINX.conf和任何包含的配置文件）以查找autoindex指令。\n"),n("code",[_._v("egrep -i '^\\s*autoindex\\s+' <main_config_path>")]),_._v(" "),n("code",[_._v("egrep -i '^\\s*autoindex\\s+' <sub_config_path>")]),_._v(" 在location下删除或者修改为 "),n("code",[_._v("autoindex off;")])]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr"),_._v(" "),n("h2",{attrs:{id:"文件权限类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件权限类"}},[_._v("#")]),_._v(" 文件权限类")]),_._v(" "),n("h3",{attrs:{id:"确保nginx配置文件权限为644"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#确保nginx配置文件权限为644"}},[_._v("#")]),_._v(" 确保Nginx配置文件权限为644")]),_._v(" "),n("p",[n("strong",[_._v("描述")])]),_._v(" "),n("p",[_._v("把控配置文件权限以抵御外来攻击")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("检查提示")])]),_._v(" "),n("p",[_._v("--")]),_._v(" "),n("hr"),_._v(" "),n("p",[n("strong",[_._v("加固建议")])]),_._v(" "),n("p",[_._v("修改Nginx配置文件权限： 执行"),n("code",[_._v("chmod 644 <conf_path>")]),_._v("来限制Nginx配置文件的权限；(<conf_path>为配置文件的路径，如默认/安装目录/conf/nginx.conf或者/etc/nginx/nginx.conf，或用户自定义，请 自行查找)")]),_._v(" "),n("hr"),_._v(" "),n("p",[_._v("操作时建议做好记录或备份")]),_._v(" "),n("hr")])}),[],!1,null,null,null);v.default=t.exports}}]);